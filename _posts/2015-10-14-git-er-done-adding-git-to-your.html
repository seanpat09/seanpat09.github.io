---
layout: post
title: 'Git ''Er Done: Adding Git to Your Salesforce Development Process'
date: '2015-10-14T07:22:00.002-07:00'
author: Sean Cuevo
tags:
- version control
- git
- apex
- salesforce
modified_time: '2015-10-14T09:32:21.772-07:00'
blogger_id: tag:blogger.com,1999:blog-4727318240760747618.post-2418936603664459448
blogger_orig_url: http://www.socalledprogrammer.com/2015/10/git-er-done-adding-git-to-your.html
---

<article class="markdown-body">
    <p>Version control is a crucial component of any development process and even more so if you are working in a team. It is so important that I will refuse to work on any project before implementing some kind of version control system even if it means I have to maintain it on my own. Not only has it saved my ass countless times, it also facilitates and speeds up collaboration for development teams.</p>
    <!--break-->
    <p><a href="https://git-scm.com/">Git</a> is my preferred version control system and after reading this post you will learn:</p>
    <ul>
        <li>How to get your Salesforce code set up in Git</li>
        <li>How to utilize version control in your development workflow</li>
    </ul>
    <h2 id="getting-your-salesforce-code-on-to-git"><a name="user-content-getting-your-salesforce-code-on-to-git" href="#getting-your-salesforce-code-on-to-git" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Getting your Salesforce code on to Git</h2>
    <p>If you don&rsquo;t have Git set up on your machine, check out these two links first:</p>
    <p><a href="https://git-scm.com/book/en/v2/Getting-Started-Installing-Git">https://git-scm.com/book/en/v2/Getting-Started-Installing-Git</a></p>
    <p><a href="https://git-scm.com/book/en/v2/Getting-Started-First-Time-Git-Setup">https://git-scm.com/book/en/v2/Getting-Started-First-Time-Git-Setup</a></p>
    <p>Next pull down the metadata that you want to track from your Salesforce production org using whichever method you prefer (Mavensmate, Eclipse, <a href="http://www.socalledprogrammer.com/2015/01/the-ant-jobs-go-marching.html">Ant</a>, etc). We&rsquo;re using pulling the code from production because it is the source of truth of your org. Even if your sandbox has new changes in it, it can be refreshed at any time or never merged into production. Production always takes precedent.</p>
    <p>If you&rsquo;re not sure which metadata types you should pull down, I recommend this package.xml file as a default:</p><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br />&lt;Package xmlns=&quot;http://soap.sforce.com/2006/04/metadata&quot;&gt;<br />    &lt;types&gt;<br />        &lt;members&gt;*&lt;/members&gt;<br />        &lt;name&gt;ApexClass&lt;/name&gt;<br />    &lt;/types&gt;<br />    &lt;types&gt;<br />        &lt;members&gt;*&lt;/members&gt;<br />        &lt;name&gt;ApexComponent&lt;/name&gt;<br />    &lt;/types&gt;<br />    &lt;types&gt;<br />        &lt;members&gt;*&lt;/members&gt;<br />        &lt;name&gt;ApexPage&lt;/name&gt;<br />    &lt;/types&gt;<br />    &lt;types&gt;<br />        &lt;members&gt;*&lt;/members&gt;<br />        &lt;name&gt;ApexTrigger&lt;/name&gt;<br />    &lt;/types&gt;<br />    &lt;types&gt;<br />        &lt;members&gt;*&lt;/members&gt;<br />        &lt;name&gt;StaticResource&lt;/name&gt;<br />    &lt;/types&gt;<br />    &lt;version&gt;34.0&lt;/version&gt;<br />&lt;/Package&gt;<br /></code></pre>
    <p>Developers will be working with these metadata types for a majority of their time and thus these will benefit from version control the most.</p>
    <p>Once you&rsquo;ve pull down your metadata open up Terminal (or Git Bash if you&rsquo;re using Windows) and navigate to the root folder of your project. This is typically the folder that holds your <strong>src</strong> folder. Run these commands to create your git repository:</p><pre><code>//creates the repo<br />git init<br /><br />//adds everything in the folder to the repo<br />git add . <br /><br />//commits code to your repo. You can change the message to whatever you want,<br />//but this is what I usually put<br />git commit -m &quot;current state of production code&quot; <br /></code></pre>
    <p>And you&rsquo;re done! Adding your git repository to a remote location is out of scope for this blog post, but I suggest using one of the following:
        <br /><em> <a href="https://bitbucket.org/">BitBucket</a> - Better for consultants because the pricing model is to pay per collaborator with unlimited private repositories<br /></em> <a href="https://github.com/">GitHub</a> - Better for product developers or those working in industry as you pay per private repo with unlimited collaborators.</p>
    <h2 id="adding-version-control-to-your-development-workflow"><a name="user-content-adding-version-control-to-your-development-workflow" href="#adding-version-control-to-your-development-workflow" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Adding Version Control to Your Development Workflow</h2>
    <p>Here&rsquo;s a really basic development workflow for any new feature you are working on:</p>
    <ol>
        <li>Create a branch off of the master branch (typically named after the feature or story number)</li>
        <li>Make a change in the code that you can describe in one sentence without using the word &ldquo;and&rdquo; (e.g. &lsquo;Stubbed out controller tests&rsquo;)</li>
        <li>Commit the change to your branch</li>
        <li>Repeat steps 2 and 3 until the feature is completed (which includes testing)</li>
        <li>Merge into the master branch</li>
        <li>Deploy the master branch to your Production org.</li>
    </ol>
    <p>Let&rsquo;s break down each of these steps into more detail:</p>
    <h3 id="1-create-a-branch-off-of-the-master-branch-typically-named-after-the-feature-or-story-number"><a name="user-content-1-create-a-branch-off-of-the-master-branch-typically-named-after-the-feature-or-story-number" href="#1-create-a-branch-off-of-the-master-branch-typically-named-after-the-feature-or-story-number" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>1. Create a branch off of the master branch (typically named after the feature or story number)</h3>
    <p>First, create or refresh a sandbox for you to develop in. You want your development org to mirror your production org as much as possible so that you know that the features you are building will integrate smoothly with what&rsquo;s currently in production. In Terminal, create a branch off of the master branch with the following commands:</p><pre><code>//Make sure you are actually in the master branch<br />git checkout master <br /><br />//Create a new branch and put yourself in it at the same time. myBranch can be named whatever you want.<br />//I usually name it after the feature you are building, or use the story number if you're doing agile<br />git checkout -b myBranch<br /></code></pre>
    <p>In your IDE, make sure you are saving files to your sandbox org, not production. You&rsquo;re now ready to start developing!</p>
    <h3 id="2-make-a-change-in-the-code-that-you-can-describe-in-one-sentence-without-using-the-word-and"><a name="user-content-2-make-a-change-in-the-code-that-you-can-describe-in-one-sentence-without-using-the-word-and" href="#2-make-a-change-in-the-code-that-you-can-describe-in-one-sentence-without-using-the-word-and" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>2. Make a change in the code that you can describe in one sentence without using the word &ldquo;and&rdquo;</h3>
    <p>Commits should be small and descriptive. This makes tracking history, comparing file differences, and reverting code much easier. It&rsquo;s easier to make sense of a bunch of small changes instead of one giant change. Also, if your history is a series of steps you have the flexibility of reverting only certain changes instead of all or nothing.</p>
    <h3 id="3-commit-the-change-to-your-branch"><a name="user-content-3-commit-the-change-to-your-branch" href="#3-commit-the-change-to-your-branch" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>3. Commit the change to your branch</h3>
    <p>After you make a (small) change, do the following in Terminal: (I&rsquo;ve included the outputs so you know what to expect)</p><pre><code>//add the file(s) you changed to git. You can also do git add .<br />//but I prefer to be explicit<br />My-Computer:myProject thisIsMe$ git add src/classes/ContactController.cls <br /><br />//View the changes you staged. Not necessary but I do it to make sure<br />//I only add what I expected to add<br />My-Computer:myProject thisIsMe$ git status<br />On branch newFeature<br />Changes to be committed:<br />  (use &quot;git reset HEAD &lt;file&gt;...&quot; to unstage)<br /><br />    modified:   src/classes/ContactController.cls<br /><br />//Commit the change to Git<br />My-Computer:myProject thisIsMe$ git commit -m 'my change'<br />[newFeature bae2c2d] my change<br /> 1 file changed, 1 insertion(+), 1 deletion(-)<br /></code></pre>
    <h3 id="4-repeat-steps-2-and-3-until-the-feature-is-completed-which-includes-testing"><a name="user-content-4-repeat-steps-2-and-3-until-the-feature-is-completed-which-includes-testing" href="#4-repeat-steps-2-and-3-until-the-feature-is-completed-which-includes-testing" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>4. Repeat steps 2 and 3 until the feature is completed (which includes testing)</h3>
    <p>Continue to make small changes until you are ready to call the feature complete. This includes any unit testing you need to do as well as any QA/UAT.</p>
    <h3 id="5-merge-into-the-master-branch"><a name="user-content-5-merge-into-the-master-branch" href="#5-merge-into-the-master-branch" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>5. Merge into the master branch</h3>
    <p>When you are done, it&rsquo;s time to merge it to the master branch:</p><pre><code>//Checkout the branch you are merging into<br />git checkout master<br /><br />//Merge the branch with the feature you've been working on<br />git merge myChange<br /></code></pre>
    <h3 id="6-deploy-the-master-branch-to-your-production-org"><a name="user-content-6-deploy-the-master-branch-to-your-production-org" href="#6-deploy-the-master-branch-to-your-production-org" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>6. Deploy the master branch to your Production org.</h3>
    <p>Once it is merged into the master branch, go ahead and deploy the code to your production org using whichever method your prefer (your IDE, change set, ant).</p>
    <h2 id="why-create-a-new-branch-why-not-just-work-in-master"><a name="user-content-why-create-a-new-branch-why-not-just-work-in-master" href="#why-create-a-new-branch-why-not-just-work-in-master" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Why create a new branch? Why not just work in master?</h2>
    <p>Working in branches gives you more flexibility and facilitates working on separate features simultaneously. Take the following example:</p>
    <p>You are tasked with adding a new feature:</p><pre><code>git checkout master<br />git checkout -b newFeature<br /></code></pre>
    <p>While you are creating that new feature, the business says there&rsquo;s a bug in production that needs to be fixed quickly. So you do the following:</p><pre><code>//Get back into the master branch, which does not include any code from the new feature<br />git checkout master<br /><br />//Create a new branch for your hot fix.<br />git checkout -b hotFix<br /></code></pre>
    <p>Once you complete the hot fix and merge it into your master branch (and then production org), you can just return to work on your new feature as if nothing happened. You don&rsquo;t have to manually remove or add code; Git did it all for you. If you want, you can also merge the hot fix into your newFeature branch so that your branch is caught up with master.</p><pre><code>git checkout newFeature<br />git merge hotFix<br /></code></pre>
    <h2 id="new-possibilities"><a name="user-content-new-possibilities" href="#new-possibilities" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>New Possibilities</h2>
    <p>While version adds some overhead to development process, it also helps you become more productive. Having a history will make debugging issues easier as you&rsquo;ll have a trail of what changed in the code when the bug arose. You&rsquo;ll also feel more empowered to make changes in the code because if something goes wrong you always have something to revert back to.</p>
    <p>Version control also opens the door to new opportunities. In the next post, we&rsquo;ll cover how to use Git to automate deployments and manage collaboration between several developers.</p>
</article>